<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Project Details</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap.css" rel="stylesheet">
	<style type="text/css">
        td
        {
        	height:		40px;
        	font-size:	15px;
        	font-weight:bold;
        }
        td.title
        {
        	width: 		250px;
        }
        span.label
        {
        	font-size:	12px;
        }
        div.panel-heading
        {
        	font-size:	15px;
        	font-weight:bold;
        }
    </style>
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="../../assets/js/html5shiv.js"></script>
      <script src="../../assets/js/respond.min.js"></script>
    <![endif]-->
</head>
<body>
	<!-- Fixed navbar -->
    <div class="navbar navbar-fixed-top navbar-inverse">
    	<div class="navbar-header">
		    <a class="navbar-brand" href="index.html">EOS</a>
		</div>
      	<div class="container">
	        <div class="navbar-collapse collapse">
	          <ul class="nav navbar-nav">
	            <li><a href="#">Home</a></li>
	            <li class="active"><a href="ProjectList.html">OSS Projects</a></li>
	            <li><a href="#about">About</a></li>
	            <li><a href="#contact">Contact</a></li>
	          </ul>
	
	          
	          <ul class="nav navbar-nav navbar-right">
	            <li><a href="">Default</a></li>
	          </ul>
	        </div><!--/.nav-collapse -->
      	</div>
    </div>

	<div class="container">
	
		<div class="page-header">
			<h1><small>Project Information</small></h1>
	  		<h1 id="name"> </h1>
		</div>
		
		
		<div class="panel panel-info">
		  <!-- Default panel contents -->
		  <div class="panel-heading">Project Summary</div>
		  <div class="panel-body">
		    <p id="desc">...</p>
		  </div>
		
		  <!-- Table -->
		  <table class="table">
		    <tr>
				<td class = title>&nbsp;&nbsp;Programming Language:</td>
				<td id="programmingLanguage"></td>
			</tr>
			<tr>
				<td class = title>&nbsp;&nbsp;Project WebSite:</td>
				<td><a  id="hostUrl" href="#"></a></td>
			</tr>
			<tr>
				<td class = title>&nbsp;&nbsp;Code Location:</td>
				<td><a  id="codeurl" href="#">Unknown</a></td>
			</tr>
			<tr>
				<td class = title>&nbsp;&nbsp;Mailing List:</td>
				<td><a  id="mailurl" href="#">Unknown</a></td>
			</tr>
						<tr>
				<td class = title>&nbsp;&nbsp;Issue Tracker:</td>
				<td><a  id="bugurl" href="#">Unknown</a></td>
			</tr>
		  </table>
		</div>
		
		<hr>
		
		<h3>Collected Data</h3><br>
		<div id="codedata" class="panel panel-default">
		  <div id="codeheader" class="panel-heading">Source Code</div>
		  <div class="panel-body" id="codedes"></div>
		</div>
		<div id="docdata" class="panel panel-default">
		  <div id="docheader" class="panel-heading">Official Documentation</div>
		  <div class="panel-body" id="docdes"></div>
		</div>
		<div id="maildata" class="panel panel-default">
		  <div id="mailheader" class="panel-heading">Mails</div>
		  <div class="panel-body" id="maildes"></div>
		</div>
		<div id="bugdata" class="panel panel-default">
		  <div id="bugheader" class="panel-heading">Bugs</div>
		  <div class="panel-body" id="bugdes"></div>
		</div>
		<div id="blogdata" class="panel panel-default">
		  <div id="blogheader" class="panel-heading">Blog Articles</div>
		  <div class="panel-body" id="blogdes"></div>
		</div>
	</div>
	
	
    <script src="js/jquery-1.10.2.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script>
    function getParameterByName(name) {
        name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
            results = regex.exec(location.search);
        return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }
    var project;
    var uuid = getParameterByName("uuid");

    function loadProjectInfo(){
    	var project;
    	$.post("GetProjectInfo?uuid=" + uuid,null,function (data){
    		project = $.parseJSON(data);
    		//alert(project.name)
			var codeindex = -1;
    		var mailindex = -1;
    		var bugindex = -1;
    		
    		for(i=0; i<project.resources.length; i++) {
    			if(project.resources[i].type == 'MailingList') mailindex = i;
    			if(project.resources[i].type == 'SourceCode') codeindex = i;
    			if(project.resources[i].type == 'IssueTracker') bugindex = i;
    		}
    		
            $("#name").html(project.name);
            $("#desc").html(project.description);
            $("#programmingLanguage").html(project.programmingLanguage);
            $("#hostUrl").html(project.hostUrl);
            $("#hostUrl").attr("href", project.hostUrl);
            if (codeindex > -1){
	            $("#codeurl").html(project.resources[codeindex].urlListString);
	            $("#codeurl").attr("href", project.resources[codeindex].urlListString);
            }
            if (mailindex > -1){
	            $("#mailurl").html(project.resources[mailindex].urlListString);
	            $("#mailurl").attr("href", project.resources[mailindex].urlListString);
            }
            if (bugindex > -1){
	            $("#bugurl").html(project.resources[bugindex].urlListString);
	            $("#bugurl").attr("href", project.resources[bugindex].urlListString);
            }
    	});
    	var task;
    	var num = 0;
    	$.post("GetCrawlerTaskInfo?puuid=" + uuid + "&type=SourceCode",null,function (data){
    		//alert(data.split("|")[1]);
    		//task = $.parseJSON(data);
    		//alert(data);
			if(data == 'null'){$("#codedes").html("Not Collected")}
			else {
	    		task = $.parseJSON(data.split("|")[0]);
	    		num = data.split("|")[1];
	    		$("#codedes").append("<a href=\"ftp://192.168.4.9/Upload/EOS/"+uuid+"/SourceCode/\"><span class=\"badge\">"+num+"</span></a>");
	    		$("#codedes").append("&nbsp;&nbsp;&nbsp;Files Collected");
	    		if (task.status == 1) {
		    		$("#codedata").attr("class", "panel panel-primary");
		    		$("#codedes").append("<span class=\"label label-success pull-right\">Collected at&nbsp;&nbsp;&nbsp;<i>"+task.finishTime+"</i></span>");
	    		} else {
		    		$("#codedata").attr("class", "panel panel-danger");
		    		$("#codedes").append("<span class=\"label label-warning pull-right\">"+"Task Aborted"+"</span>");
	    		}
			}
    	});
    	$.post("GetCrawlerTaskInfo?puuid=" + uuid + "&type=Documentation",null,function (data){
    		//alert(data.split("|")[1]);
    		//task = $.parseJSON(data);
    		//alert(data);
			if(data == 'null'){$("#docdes").html("Not Collected")}
			else {
	    		task = $.parseJSON(data.split("|")[0]);
	    		num = data.split("|")[1];
	    		$("#docdes").append("<a href=\"ftp://192.168.4.9/Upload/EOS/"+uuid+"/Documentation/\"><span class=\"badge\">"+num+"</span></a>");
	    		$("#docdes").append("&nbsp;&nbsp;&nbsp;Files Collected");
	    		if (task.status == 1) {
		    		$("#docdata").attr("class", "panel panel-primary");
		    		$("#docdes").append("<span class=\"label label-success pull-right\">Collected at&nbsp;&nbsp;&nbsp;<i>"+task.finishTime+"</i></span>");
	    		} else {
		    		$("#docdata").attr("class", "panel panel-danger");
		    		$("#docdes").append("<span class=\"label label-warning pull-right\">"+"Task Aborted"+"</span>");
	    		}
			}
    	});
    	$.post("GetCrawlerTaskInfo?puuid=" + uuid + "&type=MailingList",null,function (data){
    		//alert(data.split("|")[1]);
    		//task = $.parseJSON(data);
    		//alert(data);
			if(data == 'null'){$("#maildes").html("Not Collected")}
			else {
	    		task = $.parseJSON(data.split("|")[0]);
	    		num = data.split("|")[1];
	    		$("#maildes").append("<span class=\"badge\">"+num+"</span>");
	    		$("#maildes").append("&nbsp;&nbsp;&nbsp;Records Collected");
	    		if (task.status == 1) {
		    		$("#maildata").attr("class", "panel panel-primary");
		    		$("#maildes").append("<span class=\"label label-success pull-right\">Collected at&nbsp;&nbsp;&nbsp;<i>"+task.finishTime+"</i></span>");
	    		} else {
		    		$("#maildata").attr("class", "panel panel-danger");
		    		$("#maildes").append("<span class=\"label label-warning pull-right\">"+"Task Aborted"+"</span>");
	    		}
			}
    	});
    	$.post("GetCrawlerTaskInfo?puuid=" + uuid + "&type=IssueTracker",null,function (data){
    		//alert(data.split("|")[1]);
    		//task = $.parseJSON(data);
    		//alert(data);
			if(data == 'null'){$("#bugdes").html("Not Collected")}
			else {
	    		task = $.parseJSON(data.split("|")[0]);
	    		num = data.split("|")[1];
	    		$("#bugdes").append("<span class=\"badge\">"+num+"</span>");
	    		$("#bugdes").append("&nbsp;&nbsp;&nbsp;Records Collected");
	    		if (task.status == 1) {
		    		$("#bugdata").attr("class", "panel panel-primary");
		    		$("#bugdes").append("<span class=\"label label-success pull-right\">Collected at&nbsp;&nbsp;&nbsp;<i>"+task.finishTime+"</i></span>");
	    		} else {
		    		$("#bugdata").attr("class", "panel panel-danger");
		    		$("#bugdes").append("<span class=\"label label-warning pull-right\">"+"Task Aborted"+"</span>");
	    		}
			}
    	});
    	$.post("GetCrawlerTaskInfo?puuid=" + uuid + "&type=RelativeWeb",null,function (data){
    		//alert(data.split("|")[1]);
    		//task = $.parseJSON(data);
    		//alert(data);
			if(data == 'null'){$("#blogdes").html("Not Collected")}
			else {
	    		task = $.parseJSON(data.split("|")[0]);
	    		num = data.split("|")[1];
	    		$("#blogdes").append("<a href=\"ftp://192.168.4.9/Upload/EOS/"+uuid+"/RelativeWeb/\"><span class=\"badge\">"+num+"</span></a>");
	    		$("#blogdes").append("&nbsp;&nbsp;&nbsp;Files Collected");
	    		if (task.status == 1) {
		    		$("#blogdata").attr("class", "panel panel-primary");
		    		$("#blogdes").append("<span class=\"label label-success pull-right\">Collected at&nbsp;&nbsp;&nbsp;<i>"+task.finishTime+"</i></span>");
	    		} else {
		    		$("#blogdata").attr("class", "panel panel-danger");
		    		$("#blogdes").append("<span class=\"label label-warning pull-right\">"+"Task Aborted"+"</span>");
	    		}
			}
    	});
    }
    loadProjectInfo();
    </script>
</body>
</html>